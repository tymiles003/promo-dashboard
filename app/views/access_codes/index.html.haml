- model_class = AccessCode

.container
  %h1=t '.title', :default =>'Access Codes Dashboard for TOO BIG'
  %p
    Instructions be going here. Blah blah blah.
    %a{href: @eventbrite_event_url, target: '_new'}= @eventbrite_event_url
  %h2=t '.title', :default => 'Your Access Codes'

  %table.table.table-striped
    %thead
      %tr
        %th Access Code
        %th Invite Link
        %th Code Created At
        %th Attendees
    - num_codes_created = @access_codes.length
    - if num_codes_created > 0
      %tbody
      - codes_used = 0
      - @access_codes.each do |access_code|
        %tr
          %td= access_code.code
          %td
            - eventbrite_event_url = @eventbrite_event_url + '?access=' + access_code.code
            %a{href: eventbrite_event_url, target: '_new'}
              = eventbrite_event_url
          %td= access_code.created_at.strftime("%D %I:%M%p")
          %td
            - if access_code.attendees
              - codes_used += 1
              - access_code.attendees.each do |attendee|
                = attendee.name + ' (' + attendee.email + ') ordered at ' + attendee.ordered_at.strftime("%D %I:%M%p")
                %br
            - else
              No Attendees have ordered with this access code yet.
  %p
  - if num_codes_created > 0
    - percent = codes_used.to_i / num_codes_created.to_i * 100
    %strong= codes_used
    of your
    %strong= @access_codes.length
    access codes have been used to invite attendees
    .progress{:style => "width: 25%;"}
      .progress-bar{"aria-valuemax" => num_codes_created,
                    "aria-valuemin" => "0",
                    "aria-valuenow" => codes_used,
                    :role => "progressbar",
                    :style => 'width: ' + percent.to_s + '%;'}
        %span.sr-only
  - else
    You haven't created any access codes yet.
  = render :partial => 'new', :locals => {num_codes_created: num_codes_created}